<!DOCTYPE html>
<html lang="vi"
    th:replace="~{/views/gdienChung/templateChung.html::view(~{::main}, ~{::title})}">

    <head>
        <meta charset="UTF-8">
        <title>ƒê√°nh gi√° kh√≥a h·ªçc</title>
    </head>

    <body>
        <main class="quanlydanhgia">
            <div class="container py-4">

                <!-- Header Section -->
                <div class="header-section">
                    <div class="header-content">
                        <h1 class="page-title">
                            <i class="fas fa-star"></i> ƒê√°nh gi√° kh√≥a h·ªçc
                        </h1>
                        <p class="page-subtitle">Qu·∫£n l√Ω v√† theo d√µi ƒë√°nh gi√° t·ª´
                            h·ªçc vi√™n</p>
                    </div>
                </div>

                <form method="get"
                    th:action="@{/giangvien/danh-gia-tu-khoa-hoc}"
                    class="filter-form p-4 rounded shadow">
                    <div class="row g-3 align-items-end">

                        <!-- Kh√≥a h·ªçc -->
                        <div class="col-md-5">
                            <label class="form-label fw-semibold">üìö Kh√≥a
                                h·ªçc</label>
                            <select name="khoahocId"
                                class="form-select custom-select">
                                <option value>-- T·∫•t c·∫£ --</option>
                                <option th:each="kh : ${dsKhoaHoc}"
                                    th:value="${kh.khoahocId}"
                                    th:text="${kh.tenKhoaHoc}"
                                    th:selected="${kh.khoahocId == khoaHocDaChon}">
                                </option>
                            </select>
                        </div>

                        <!-- S·ªë sao -->
                        <div class="col-md-4">
                            <label class="form-label fw-semibold">‚≠ê ƒê√°nh
                                gi√°</label>
                            <select name="sao"
                                class="form-select custom-select">
                                <option value>-- T·∫•t c·∫£ --</option>
                                <option th:each="i : ${#numbers.sequence(1,5)}"
                                    th:value="${i}"
                                    th:text="${i + ' sao'}"
                                    th:selected="${i == saoDaChon}">
                                </option>
                            </select>
                        </div>

                        <!-- N√∫t -->
                        <div class="col-md-3 d-flex gap-2">
                            <button type="submit"
                                class="btn btn-primary flex-fill">
                                üîç L·ªçc
                            </button>
                            <a th:href="@{/giangvien/danh-gia-tu-khoa-hoc}"
                                class="btn btn-outline-secondary flex-fill">
                                üóëÔ∏è X√≥a
                            </a>
                        </div>
                    </div>
                </form>

                <!-- T·ªïng quan -->
                <div th:if="${khoaHocChiTiet == null}">
                    <div class="table-responsive">
                        <table
                            class="table table-hover table-bordered align-middle custom-table">
                            <thead class="table-primary text-center">
                                <tr>
                                    <th>
                                        <i class="bi bi-journal-text me-1"></i>
                                        T√™n kh√≥a h·ªçc
                                    </th>
                                    <th>
                                        <i class="bi bi-people me-1"></i> S·ªë
                                        l∆∞·ª£t ƒë√°nh gi√°
                                    </th>
                                    <th>
                                        <i class="bi bi-star-half me-1"></i>
                                        ƒêi·ªÉm trung b√¨nh
                                    </th>
                                    <th>
                                        <i class="bi bi-gear me-1"></i> H√†nh
                                        ƒë·ªông
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="row : ${tongQuanDanhGia}">
                                    <td
                                        th:text="${row.khoahoc.tenKhoaHoc}"></td>
                                    <td class="text-center fw-semibold"
                                        th:text="${row.tong}"></td>
                                    <td class="text-center text-warning fw-bold"
                                        th:text="${#numbers.formatDecimal(row.diemTB, 1, 1)} + ' ‚≠êÔ∏è'">
                                    </td>
                                    <td class="text-center">
                                        <a
                                            th:href="@{/giangvien/danh-gia-tu-khoa-hoc(khoahocId=${row.khoahoc.khoahocId})}"
                                            class="btn btn-sm btn-outline-primary">
                                            <i class="bi bi-eye"></i> Xem chi
                                            ti·∫øt
                                        </a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chi ti·∫øt -->
                <div th:if="${khoaHocChiTiet != null}">
                    <div class="card mb-4 course-info-card">
                        <div class="card-body">
                            <h5 class="card-title course-title">
                                <i class="fas fa-graduation-cap"></i> Th√¥ng tin
                                kh√≥a h·ªçc
                            </h5>
                            <div class="course-details">
                                <div class="info-item">
                                    <div class="info-label">
                                        <i class="fas fa-hashtag"></i> M√£ kh√≥a
                                        h·ªçc:
                                    </div>
                                    <div class="info-value course-id"
                                        th:text="${khoaHocChiTiet.khoahocId}">KH001</div>
                                </div>

                                <div class="info-item">
                                    <div class="info-label">
                                        <i class="fas fa-book"></i> T√™n kh√≥a
                                        h·ªçc:
                                    </div>
                                    <div class="info-value course-name"
                                        th:text="${khoaHocChiTiet.tenKhoaHoc}">L·∫≠p
                                        tr√¨nh Web Frontend v·ªõi React.js</div>
                                </div>

                                <div class="info-item"
                                    th:if="${khoaHocChiTiet.moTa != null}">
                                    <div class="info-label">
                                        <i class="fas fa-align-left"></i> M√¥ t·∫£:
                                    </div>
                                    <div class="info-value course-description"
                                        th:text="${khoaHocChiTiet.moTa}">Kh√≥a
                                        h·ªçc to√†n di·ªán v·ªÅ ph√°t tri·ªÉn giao di·ªán
                                        web hi·ªán ƒë·∫°i s·ª≠ d·ª•ng React.js, bao g·ªìm
                                        c√°c kh√°i ni·ªám c∆° b·∫£n ƒë·∫øn n√¢ng cao.</div>
                                </div>

                                <div class="stats-row">
                                    <div class="stat-item">
                                        <div class="stat-icon">
                                            <i class="fas fa-users"></i>
                                        </div>
                                        <div class="stat-content">
                                            <div class="stat-label">T·ªïng l∆∞·ª£t
                                                ƒë√°nh gi√°</div>
                                            <div class="stat-value"
                                                th:text="${tongLuot}">156</div>
                                        </div>
                                    </div>

                                    <div class="stat-item">
                                        <div class="stat-icon rating-icon">
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <div class="stat-content">
                                            <div class="stat-label">ƒêi·ªÉm trung
                                                b√¨nh
                                            </div>
                                            <div
                                                class="stat-value rating-value">
                                                <span
                                                    th:text="${#numbers.formatDecimal(diemTrungBinh, 1, 1)}">4.8</span>
                                                <span
                                                    class="star-emoji">‚≠êÔ∏è</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div th:if="${#lists.isEmpty(dsDanhGia)}"
                        class="empty-state-container">
                        <div class="empty-state-card">
                            <div class="empty-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <h4 class="empty-title">Ch∆∞a c√≥ ƒë√°nh gi√° n√†o</h4>
                            <p class="empty-message">Hi·ªán t·∫°i ch∆∞a c√≥ ƒë√°nh gi√°
                                n√†o ph√π h·ª£p v·ªõi ti√™u ch√≠ t√¨m ki·∫øm c·ªßa b·∫°n.</p>
                            <div class="empty-suggestions">
                                <div class="suggestion-item">
                                    <i class="fas fa-lightbulb"></i>
                                    <span>Th·ª≠ ƒëi·ªÅu ch·ªânh b·ªô l·ªçc t√¨m ki·∫øm</span>
                                </div>
                                <div class="suggestion-item">
                                    <i class="fas fa-refresh"></i>
                                    <span>Ki·ªÉm tra l·∫°i sau</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Review Item -->
                    <div th:each="dg : ${dsDanhGia}"
                        class="card mb-3 shadow-sm border-0 review-item">
                        <div class="card-body d-flex">
                            <!-- Avatar -->
                            <div class="flex-shrink-0">
                                <img th:src="${dg.taikhoan.avatar}" alt="Avatar"
                                    class="rounded-circle border"
                                    style="width: 50px; height: 50px; object-fit: cover;" />
                            </div>

                            <!-- N·ªôi dung -->
                            <div class="ms-3 w-100">
                                <div
                                    class="d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0 fw-bold text-dark"
                                        th:text="${dg.taikhoan.name}">
                                        T√™n ng∆∞·ªùi d√πng
                                    </h6>
                                    <small class="text-muted review-date"
                                        th:text="${#temporals.format(dg.ngayDanhGia, 'dd/MM/yyyy')}">
                                        22/07/2025
                                    </small>
                                </div>

                                <!-- Stars -->
                                <div class="review-stars my-1">
                                    <span
                                        th:each="i : ${#numbers.sequence(1, dg.diemDanhGia)}"
                                        class="text-warning">‚òÖ</span>
                                    <span th:if="${dg.diemDanhGia < 5}"
                                        th:each="j : ${#numbers.sequence(dg.diemDanhGia + 1, 5)}"
                                        class="text-secondary">‚òÖ</span>
                                </div>

                                <!-- N·ªôi dung ƒë√°nh gi√° -->
                                <p class="mb-0 text-muted"
                                    th:text="${dg.noiDung}">
                                    N·ªôi dung ƒë√°nh gi√°
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <a th:href="@{/giangvien/danh-gia-tu-khoa-hoc}"
                            class="btn btn-outline-primary">‚Üê Quay l·∫°i t·ªïng
                            quan</a>
                    </div>
                </div>
            </div>
        </main>
    </body>

</html>